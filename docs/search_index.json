[
["Intro.html", "Chapter 1 Introduction 1.1 NatureCounts and R 1.2 Prerequisites 1.3 Acknowledgements", " Chapter 1 Introduction NatureCounts is a website hosted and managed by Birds Canada, Canada’s leading scientific non-government organization dedicated to increasing the understanding, appreciation and conservation of wild birds and their habitats . Birds Canada specializes in citizen science long-term monitoring programs using a partnership-based model. Citizen science has been found to be the most cost-effective way to monitor bird populations across large geographic areas. In Canada, over 16,000 volunteers are currently involved in Birds Canada’s programs. Launched in January 2008, NatureCounts is the first Canadian node of the Avian Knowledge Network. It serves as an online data dissemination portal to facilitate the collection, management and sharing of biological data. NatureCounts hosts hundreds of datasets, representing well over 140 million occurrences of birds. These include virtually all of Birds Canada’s monitoring initiatives, such as Breeding Bird Atlases, eBird Canada, the Marsh Monitoring Program, Nocturnal Owl Surveys, as well as many other major initiatives to which Birds Canada contributes in some capacity (e.g., Canadian Migration Monitoring Program, HawkCount and the Raptor Population Index, Monarch Knowledge Network, Breeding Bird Survey, Christmas Bird Count, Project FeederWatch). What can you do on the NatureCounts webportal? You can explore the data resources of NatureCounts via interactive maps that allow you to view the distribution of bird populations during any time of the year and across a variety of different sources. You can obtain and visualize information on long term population trends of Canadian birds. You can explore an individual species pattern of distribution or the species richness of a location via dynamically generated summary tables and graphs. Finally, much of the observational data can be downloaded for your own personal research! 1.1 NatureCounts and R The natuecounts R package was create to allow users to directly access and download data from NatureCounts into R. The goal of this online book is to show NatureCounts users how to use the R statistical programming language to access, filter, summarize, and visualize naturecounts data. Moving forward, we intend to create more advanced tutorials which explore analytical procedures suitable for various datasets. If you have suggestions for additional content, please let us know by emailing dethier@birdscanada.org Throughout this book we use fictious and subsets of real datasets to illustrate how to access, manage, explore and visualize NaturecCounts data in R. We recommend that you run through the sample code in each chapter with the sample dataset before doing the exercises or using own data. 1.2 Prerequisites This book assumes that you have a basic understanding of R. We recommend that you become familiar with ‘R for Data Science’ by Garrett Grolemund and Hadley Wickham, which covers how to import, visualize, and summarize data in R using the tidyverse collection of R packages. 1.3 Acknowledgements The text in this document were adapted from the NatureCount webpage and the NatureCounts GitHub repository. The structure of this book follows that of the Motus R Book. Online tutorials are avaiable for the NatureCounts R-package, which are referenced throughout this document. You are encouraged to review these tutorials for additional examples and more advanced options. Many people have contrubuted to the NatureCounts web interface and the R package, including, Denis Lepage, Steffi LaZerte, and Catherine Jardine. The development of the NatureCounts web interface, R package, and accompanying online book were made possible by funding provided by Environment and Climate Change Canada and the generosity of donors to Birds Canada. Thank you! "],
["Package2.html", "Chapter 2 Loading R Packages 2.1 Installing the NatureCounts package 2.2 Installing additional packages", " Chapter 2 Loading R Packages The functionalities of some packages may require updated versions of R and RStudio. To avoid errors, please ensure you are using the most recent releases of R and RStudio, and update your R packages. update.packages() 2.1 Installing the NatureCounts package You can install NatureCounts from GitHub with the remotes package: install.packages(&quot;remotes&quot;) remotes::install_github(&quot;BirdStudiesCanada/naturecounts&quot;) After installation, you need to load the package each time you open a new R session. library(naturecounts) 2.2 Installing additional packages Throughout the book we use tidyverse, which is a collection of R packages for data science, including tidyr, dplyr, and ggplot2, among others This package can be installed from CRAN and loaded into R as follows: install.packages(&quot;tidyverse&quot;) library(tidyverse) You may find additional packages are needed to manipulate and visualize your data. For example, if you are interested in Mapping Observation a suite of packages need to be installed and loaded. The process is similar to that previously decribe. "],
["Data3.html", "Chapter 3 Understanding and Viewing Data 3.1 Data Structure 3.2 Levels of Data Access 3.3 Authorizations 3.4 Viewing information about NatureCounts collections 3.5 Metadata codes and decriptions 3.6 Examples 3.7 Exercises", " Chapter 3 Understanding and Viewing Data This chapter begins with a brief introduction to the structure of the NatureCounts database, followed by a description of access levels and how to create a user account. We then provide instructions on how to view data from various collections and apply filters. 3.1 Data Structure The Bird Monitoring Data Exchange (BMDE) was developed to be a standardized data exchange schema to promote the sharing and analysis of avain observational data. The schema is the core sharing standard of the Avian Knowledge Network.The BMDE (currently version 2.0) includes 169 core fields that are capable of capturing all metrics and descriptors associated with a bird observation. The BMDE schema was extended in 2018, and the complete version now includes 265 fields. By default, the NatureCounts package downloads the data with the minimum set of fields/columns. However, for more advanced applications, users may wish to specify which fields/columns to return using the field_set and fields options in the nc_data_dl function. For help with this feature, see the github acticle ‘Selecting columns and fields to download’. 3.2 Levels of Data Access NatureCounts host many datasets, representing in excess of 140 million occurrence records, with a primary focus on Canadian bird monitoring data. Many of those datasets are from project lead by Birds Canada and/or its partners. While we thrive to make our data as openly available as possible, we also need to recognize the need of our partners and funders. NatureCounts has five Levels of Data Access, which define how each dataset can be used. Those levels are set individually for each dataset, in consultation with the various partners and data custodians involved. Level 0: most restricted (archival only) Level 1: archival only, metadata visible Level 2: data used for visualizations only Level 3: data available to third parties by request Level 4: data shared with external portals and avaialble by request Level 5: open access All contributing members of NatureCounts have complete authority over the use of the data they have provided, and can withhold data at any time from any party or application. All users of any NatureCounts data must clearly acknowledge the contribution of the members who are making data available. Each dataset comes with its own Data Sharing Policy that defines the various conditions for data usage. You can view the Data Access Level for each collection on the NatureCounts Datasets page or using the metadata function (see akn_level): meta_collections() 3.3 Authorizations To access data using the NatureCounts R package, you must sign up for a free account. Further, if you would like to access Level 3 or 4 collections you must make a data request. For step-by-step visual instructions, we encourage you to watch: NatureCounts: An Introductory Tutorial. 3.4 Viewing information about NatureCounts collections First, lets use the NatureCounts R package to view the number of records available for different collections. To do this we use the nc_count function. You can view all the available collections and the number of observations using the default setting. If a username is provided, the collections are filtered to only those available to the user. Otherwise all counts from all data sources are returned (default: show = “all”). nc_count() Or you can view the collections for which you have access using your username/password. Here we use the sample account. If you use your own account, you will be prompted for a password. nc_count(username = &quot;sample&quot;) Further refinements can be applied to the nc_count function using filters Options include: collections, project_id, species, years, doy (day-of-year), region, and site_type. 3.5 Metadata codes and decriptions There are metadata associated with the various agruments used in the nc_count and nc_data_dl functions, the latter you will use in Chapter 4. These are stored locally and can be accessed anytime to help filter your data view or download query. They include: meta_country_codes: country codes meta_statprov_codes: state/Province codes meta_subnational2_codes: subnational2 codes meta_iba_codes: Important Bird Area (IBA) codes meta_bcr_codes: Bird Conservation Region (BCR) codes meta_utm_squares: UTM Square codes meta_species_authority: species taxonomic authorities meta_species_codes: alpha-numeric codes for avian species meta_species_taxonomy: codes and taxonomic information for all species meta_collections: collections names and descriptions meta_breeding_codes: breeding codes and descriptions meta_project_protocols: project protocols meta_projects: projects ids, names, websites, and descriptions meta_protocol_types: protocol types and descriptions Comprehensive reference articles are availble online for retrieving Region and Species codes. We do not repeat those material here, but encourage you to review these prior to proceeding. You can explore the metadata materials using one line of code. For example, you can view the Important Bird Area (iba) metadata using: meta_iba_codes() 3.6 Examples Here are a few examples for you to work through to become familar with the nc_count function. Example 1: Determine the number of collections and records for a specific region. The options include: country, statprov, subnational2, iba, bcr, utm_squares, bbox. You can find details and examples on how to search_region at the link provided. The following code will retrieve all available collections and number of records for British Columbia search_region(&quot;British Columbia&quot;, type = &quot;statprov&quot;) nc_count(region = list(statprov = &quot;BC&quot;)) Example 2: Detemine the number of records for a specific species. You can find details and examples on how to search_species_code based on common names and search_species based on 4 letter alpha code at the links provided. The following code will retrieve all available collections and number of records for Red-headed Woodpecker search_species(&quot;Red-headed Woodpecker&quot;) nc_count(species = 10060) Example 3: We can further refine the Red-headed Woodpeacker example (above) by filtering the species-specific data by region (e.g., Bird Conservation Region 11), time period (e.g., 2015-2019), or a combination of both. nc_count(species = 10060, region=list(bcr=&quot;11&quot;)) nc_count(species = 10060, year=c(2015, 2019)) nc_count(species = 10060, region=list(bcr=&quot;11&quot;), year=c(2015, 2019)) 3.7 Exercises Now apply your newly aquired skills! Excersice 1: If you are interesting in doing a research project on Snowy Owls in Quebec, which three collections are you most likely to consider using (i.e., which have the most data)? Answer: EBird-CA-QC, OISEAUXQC, CBC Exercise 2: How many records of Gadwal are in the British Columbia Coastal Waterbird Survey collection? What if you are only interest in records from 2010-2019, how many records are available? Answer: 702, 389 "],
["Download4.html", "Chapter 4 Downloading and Filtering Data 4.1 Downloading NatureCounts data 4.2 Applying Filters 4.3 Examples 4.4 Exercises", " Chapter 4 Downloading and Filtering Data This chapter jumps right into downloading NatureCounts data, which builds directly on the skills developed in Chapter 3. 4.1 Downloading NatureCounts data Open access collections are available for download without a username/password, however, we encourage you to sign up for a free account. Here we demonstrate how to download the Ontario Whip-poor-will collection (WPWI), since it is Open Access (Level 5) and contains relatively few records (n = 3012). Click here for more information on this dataset. WPWI1&lt;-nc_data_dl(collections=&quot;WPWI&quot;, username = &quot;sample&quot;, info=&quot;test data download&quot;) You should now see a copy of the WPWI collection in the upper right panel of RStudio under the Environment tab. Notice in the code that info needs to be provided. This is a short description of reason for the download. This does not need to be specified when using the nc_count function. To access Level 3 or 4 collections you must sign up for a free account and request permission from the data custodian. For a complete list of datasets and access level, visit the NatureCounts datasets page or use the meta_collection() function. Here you can brows information on each dataset prior to requesting access. To make a data request, use the NatureCounts Download Data query tool. For step-by-step visual instructions, we encourage you to watch: NatureCounts: An Introductory Tutorial. You will receive an email confirmation when your request has been approved, which will contain your request_id. This number will be used to download your newly acquired dataset into R. There is also a build in function that allows you to check the status of your request and retreive your request_id: nc_requests(username=&quot;sample&quot;) Here is sample code to download Access Level 3 or 4 data: my_data &lt;- nc_data_dl(collections = &quot;CBC&quot;, request_id = 000000, username = &quot;USER&quot;, info = &quot;MY REASON&quot;) Note: This code is not functional and is here to serve as a structural example. You will need to insert your collection, request_id, username, and info in the code chunk above to make this work. If you applied filters to the web portal data request (e.g., species, region, year), you will only receive the subset of the dataset you requested. 4.2 Applying Filters The filters applied in Chapter 3 when using the nc_count view function are also used for the nc_data_dl download function. Again, these options include: collections, project_id, species, years, doy (day-of-year), region, and site_type. You may also wish to specify which fields/columns to return using the field_set and fields options in the nc_data_dl function. For help with this feature, see the github article ‘Selecting columns and fields to download’. Please review the resources provided on filter metadata prior to proceeding. The users can specify up to 3 filter options in the download process and should try to limit redundancies in filters. In most cases, one of these options will be collections, since authorization is given independently for each dataset (i.e., collection). If the user chooses to select species, then only collections the user has authorization to access will be used to retrieve species-specific data. This differs from the nc_count function, which by default shows you all the records available in each collection. 4.3 Examples Here are a few examples for you to work through to become familiar with the nc_data_dl function. Example 1: We will use the Ontario Whip-poor-will collection (WPWI) again for this example. After reviewing the online material, here, you notice that the main survey ran from 2010 to 2012, but that additional surveys were conducted between 2009 and 2013. For your research, you only want data collected during the main survey window. Futher, the survey was Ontario-wide, but most effort and records are from southern Ontario. Let’s further limit the data to those collected south of the Canadian Shield, which is approximated with BCR 13. WPWI_filter&lt;-nc_data_dl(collections=&quot;WPWI&quot;, years=c(2010, 2012), region=list(bcr=&quot;13&quot;), username = &quot;sample&quot;, info=&quot;test data download&quot;) You will notice that the number of records in the filtered WPWI download (WPWI_filter = 754) is substantially less than the number of records in the full dataset (WPWI = 3012) downloaded in Chapter 3. Example 2: Rather than using BCR 13 to approximate the study area, you are interested in just looking at records collected on the Bruce Peninsula for the full time period. You decide to use spatial data to filter observations. Specifically, you create a bounding box, using coordinates from Google Map, which reflects latitude and longitude limits to extract these data. WPWI_bb&lt;-nc_data_dl(collections=&quot;WPWI&quot;, region = list(bbox = c(left = -81.7, bottom = 44.5, right = -80.9, top = 45.3)), username = &quot;sample&quot;, info=&quot;test data download&quot;) You will notice there are now even fewer observation records (WPWI_bb = 72) 4.4 Exercises Now apply your newly aquired skills! Exercise 1: You (user “sample”) are from the Northwest Territories and interested in learning more about breeding birds in your region. First, you identify the NatureCounts dataset most suitable for this exercise using the nc_count function. Next, you decide to focus your download to only include Blackpoll Warbler data collected over the past 5 years (2015-2020). How many observation records did you download? Answer: BBS50-CAN, 75 Exercise 2: You (user “sample”) are birding in the Beaverhill Lake Important Bird Area (iba) in May. You think you hear a Bobolink! You are curious if this species has been detected here in the month of May. You choose to download the records you have authorization to freely access from NatureCounts. How many observation records did you download? What year are these records from? Answer: 2 (or 3 if you included Feb 29 in the doy calculation), 1988 "],
["Manip5.html", "Chapter 5 Data Manipulation 5.1 Basic data wrangling 5.2 Helper Functions 5.3 Exercies", " Chapter 5 Data Manipulation You have successfully downloaded your NatureCounts dataset and are ready to explore and summarize the data. In this chapter we will demonstrate how to do some basic data manipulations and summaries. The possibilities are endless, so we try to focus on examples we think would be most valuable to users. We intend to develop collection and protocol_id specific data manipulation and analysis code in the future. If you have specific requests or would like to contribute your existing code, please contact dethier@birdscanada.org. 5.1 Basic data wrangling Recall in Chapter 2 you installed the tidyverse package, which included dplyr for data manipulations. You are encouraged to learn more about this function by reviewing the Data Transformations chapter in “R for Data Science” by Hadley Wickham and Garrett Grolemund. We also recommend you print a copy of the RStudio Data Wrangling cheat sheet as a reference document. We are going to apply three key dplyr functions which will give you some of the basic tools needed to solve the vast majority of your data manipulation challenges. These functions include: Select: Pick variables by their names Filter: Pick observations by their values Summarise: Collapse many values down to a single summary Let’s continue using the Ontario Whip-poor-will collection for this chapter. WPWI&lt;-nc_data_dl(collections=&quot;WPWI&quot;, username = &quot;sample&quot;, info=&quot;test data download&quot;) 5.1.1 Select You will notice that Naturecounts datasets have many fields (i.e., columns) available. Generally, you will only want a few of these fields for your summary or analysis. Recall the complete version of the BMDE includes 265 fields. The number of variables downloaded from the BMDE will depend on the fields_set, which is by default “minimum” (57 fields). You can narrow in on the variables you are interested in with the select() function, which allows you to subset the dataframe based on the names of the variables. For example, we are going to select() a subset of variables from the WPWI dataset that we need for our summary: WPWI_select&lt;-WPWI %&gt;% select (&quot;ObservationCount&quot;, &quot;SurveyAreaIdentifier&quot;, &quot;RouteIdentifier&quot;, &quot;species_id&quot;, &quot;latitude&quot;, &quot;longitude&quot;, &quot;bcr&quot;, &quot;survey_day&quot;, &quot;survey_month&quot;, &quot;survey_year&quot;) 5.1.2 Filter Often there are observational records in a database that are not needed. We could have filtered these records out using the nc_data_dl() filters. However, we can also use the dplyr::filter() function, which allows us to subset observations based on their row values. Observations are selected using: Comparison operators:&gt;, &gt;=, &lt;, &lt;=, != (not equal), == (equal) Logical operators: &amp; (and), | (or), ! (is not) There are worked examples provided in the Filtering data after download article on Github to get you started with applying filters. These include: Categorical filters Numerical filters Date filters Here we provide a few additional examples for you to work with. First, lets apply a simple filter() that subsets the data based on a single survey month: WPWI_June&lt;-WPWI_select %&gt;% filter(survey_month==6) Now lets try multiple survey months by adding a logical operator: WPWI_JJ&lt;-WPWI_select %&gt;% filter(survey_month==6 |survey_month==7) #Alternatively this can be written as: WPWI_JJ&lt;-WPWI_select %&gt;% filter(survey_month %in% c(6,7)) We can continue to add to the complexity of our filter: WPWI_multi&lt;-WPWI_select %&gt;% filter(survey_month %in% c(6,7) &amp; bcr==12 &amp; survey_year&gt;=2010 &amp; survey_year&lt;=2012) 5.1.3 Summarise Now that we have selected the columns we need for our analysis and limited the data to the observation records we wish to use, we will want to summarise what we have left! The summarise() function is most useful if pair it with group_by() argument, because this changes the unit of analysis from the complete dataset to individual groups. For example, say we want to determine how many point count stops were on each Route. We will want to group observations by RouteIdentifier and summarise the number of district SurveyAreaIdentifier. WPWI_Route&lt;-WPWI_multi %&gt;% group_by(RouteIdentifier) %&gt;% summarise(Nstops=n_distinct(SurveyAreaIdentifier)) Or we might want to know how many routes where run in each year. WPWI_Year&lt;-WPWI_multi %&gt;% group_by(survey_year) %&gt;% summarise(Nroute=n_distinct(RouteIdentifier)) Finally, lets look to see how many Observations of WPWI were made on each route in each year. First we need to replace the ‘NA’ with zero count and ensure this variable is numeric. WPWI_multi$ObservationCount[is.na(WPWI_multi$ObservationCount)] &lt;- 0 WPWI_Obs&lt;-WPWI_multi %&gt;% group_by(RouteIdentifier, survey_year) %&gt;% summarise(MeanObs=mean(as.numeric(ObservationCount))) No WIWP were detected in our subset of the data!! No wonder this speices is listed as threatened in the province. 5.2 Helper Functions There are a few additional helper functions built into the NatureCounts R package that you may find useful. At present, they include: format_dates:Creates and adds date and day-of-year (doy) field/columns to data formate_zero-fill: Zero-fill the species presence data by adding zero observations counts (absences) to an existing NatureCounts dataset The zero-fill function is particularly important if you want to ensure your dataset is complete! 5.3 Exercies Exercise 1: You (user “sample”) are doing a research project using the fall migration monitoring data collected at Vaseux Lake Bird Observatory, British Columbia. You request the open access data from 2017-2020. After you request this subset of the collection, you need to determine the number of unique days Gray catbirds were records in each year? Answer: 2017 = 20 2018 = 23 Exercise 2: Building off the same dataset used in Exercise 1, you now want to zero-fill the dataframe to ensure it is complete for your study on Gray catbirds. How many records (rows) are in the zero-fill Gray catbird dataframe? Answer: 6709 "],
["Visual6.html", "Chapter 6 Data Visualisation 6.1 Plotting 6.2 Mapping", " Chapter 6 Data Visualisation You have successfully downloaded and summarised your NatureCounts dataset. In this chapter we will demonstrate how to do some basic visulizations with plots. 6.1 Plotting Plotting your data is a powerful way to detect patterns and make results stand out. Recall in Chapter 2 you installed the tidyverse package, which included ggplot2 for data visulizations. You are encouraged to learn more about this function by reviewing Cookbook for R. We also recommend you print a copy of the RStudio Data Visualization cheat sheet as a reference document. At the end of Chapter 5 you were exploring fall migration monitoring data collected at Vaseux Lake Bird Observatory, British Columbia. Let’s continue using this dataset for our plotting example and download the data for 2015-present. First, lets apply our previously aquired skills to download the filtered dataset and zero-fill for GRCA, while also keep some extra variables. VLBO&lt;-nc_data_dl(collections=&quot;CMMN-DET-VLBO&quot;, years=c(2015, NA), username = &quot;sample&quot;, info = &quot;test plot&quot;) GRCA&lt;-format_zero_fill(VLBO, species= 15900, by=c(&quot;SamplingEventIdentifier&quot;, &quot;survey_year&quot;, &quot;survey_month&quot;, &quot;survey_day&quot;)) First, we are interested if there are any noticible patterns in migration timing. For this, we will use the add date and day-of-year helper function to add two new columbs to the dataframe. GRCA_dates&lt;-format_dates(GRCA) Now we can plot raw counts (y-axis) for each day-of-year (x-axis). ggplot(data = GRCA_dates) + geom_point(aes(x = doy, y = ObservationCount)) What you will notice is that there isn’t an obvious peak in migration for this species, but a realtively constant number of individuals counted throughout the season. Next, we are interested in visually examining the mean number of migrant GRCA each year, to see if there are any noticible changes over time. First, we need to summarise the data: #use this shortcut function to calculate the standard error se &lt;- function(x) sd(x) / sqrt(length(x)) GRCA_year&lt;-GRCA %&gt;% group_by(survey_year) %&gt;% summarise (MeanObs=mean(ObservationCount), SEObs = se(ObservationCount)) %&gt;% mutate (yrmin=MeanObs+SEObs, yrmax=MeanObs-SEObs) Now we can create the plot: ggplot(data = GRCA_year) + geom_pointrange(aes(x = survey_year, y=MeanObs, ymin=yrmin, ymax=yrmax)) You will notice there was a large increase in the mean number of GRCA observed in 2018 compared to the previous three years. You might now be wondering why…. 6.2 Mapping There is a comprehensive tutorial online for Mapping Observation. The materials are not repeated here. We encourage you to check this out if are interested in mapping your data. "]
]
